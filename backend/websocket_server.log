2025-05-17 11:17:24,080 - websocket_server - WARNING - Kh√¥ng th·ªÉ import t·ª´ chatbot.py. S·ª≠ d·ª•ng h√†m mock.
2025-05-17 11:17:24,081 - websocket_server - WARNING - Kh√¥ng th·ªÉ import DepartmentInfoTool. S·ª≠ d·ª•ng mock class.
2025-05-17 11:17:24,084 - websocket_server - INFO - Kh·ªüi ƒë·ªông server WebSocket t·∫°i 0.0.0.0:8090
2025-05-17 11:17:24,145 - websockets.server - INFO - server listening on 0.0.0.0:8090
2025-05-17 11:17:24,145 - websocket_server - INFO - Server WebSocket ƒëang ch·∫°y t·∫°i ws://0.0.0.0:8090
2025-05-17 11:17:24,145 - websocket_server - INFO - ƒê√£ c·∫•u h√¨nh ping_timeout=6000 gi√¢y, ping_interval=60 gi√¢y
2025-05-17 11:17:58,030 - websockets.server - INFO - connection open
2025-05-17 11:18:00,782 - websocket_server - INFO - Nh·∫≠n tin nh·∫Øn d·∫°ng JSON: {"content":"test alo alo /no_think","session_id":""}
2025-05-17 11:18:00,783 - websocket_server - INFO - Session ID kh√¥ng ƒë∆∞·ª£c cung c·∫•p trong tin nh·∫Øn JSON, s·ª≠ d·ª•ng current_session_id: 16b1f3ea-b548-4dc1-91ef-f517c74092b7
2025-05-17 11:18:00,783 - websocket_server - INFO - Session ID t·ª´ client (sau khi ki·ªÉm tra): 16b1f3ea-b548-4dc1-91ef-f517c74092b7
2025-05-17 11:18:00,784 - websocket_server - INFO - T·∫Øt ch·∫ø ƒë·ªô thinking cho c√¢u h·ªèi: test alo alo /no_think...
2025-05-17 11:18:00,784 - websocket_server - INFO - Nh·∫≠n tin nh·∫Øn th√¥ng th∆∞·ªùng: test alo alo /no_think, enable_thinking=False
2025-05-17 11:18:00,784 - websocket_server - INFO - Kh√¥ng c√≥ l·ªãch s·ª≠ tin nh·∫Øn cho phi√™n n√†y
2025-05-17 11:18:00,785 - websocket_server - INFO - Ph√¢n t√≠ch c√¢u h·ªèi: Ph√≤ng ban=None, Lo·∫°i=general, Thinking=False
2025-05-17 11:18:00,785 - websocket_server - INFO - X·ª≠ l√Ω streaming response cho: 'test alo alo /no_think', ph√≤ng ban: None, session_id: 16b1f3ea-b548-4dc1-91ef-f517c74092b7
2025-05-17 11:18:00,785 - websocket_server - INFO - Session ID nh·∫≠n ƒë∆∞·ª£c: 16b1f3ea-b548-4dc1-91ef-f517c74092b7
2025-05-17 11:18:00,786 - websocket_server - INFO - Ph√°t hi·ªán l·ªánh /no_think, t·∫Øt ch·∫ø ƒë·ªô thinking cho: test alo alo
2025-05-17 11:18:00,786 - websocket_server - INFO - X·ª≠ l√Ω streaming response. Query: 'test alo alo', Mode thinking: False
2025-05-17 11:18:00,786 - websocket_server - INFO - Kh√¥ng c√≥ l·ªãch s·ª≠ tin nh·∫Øn cho phi√™n n√†y
2025-05-17 11:18:00,786 - websocket_server - INFO - Ph√¢n t√≠ch c√¢u h·ªèi: Ph√≤ng ban=None, Lo·∫°i=general, Thinking=False
2025-05-17 11:18:00,787 - websocket_server - INFO - Query th·ª±c t·∫ø g·ª≠i ƒë·∫øn m√¥ h√¨nh: test alo alo /no_think
2025-05-17 11:18:00,787 - websocket_server - INFO - C√¢u h·ªèi chung, ch·∫ø ƒë·ªô thinking: False
2025-05-17 11:18:00,787 - websocket_server - INFO - ƒê√£ l∆∞u h·ªôi tho·∫°i chung v√†o l·ªãch s·ª≠ c·ªßa session 16b1f3ea-b548-4dc1-91ef-f517c74092b7
2025-05-17 11:19:18,362 - websockets.server - INFO - connection open
2025-05-17 11:19:19,935 - websockets.server - INFO - connection open
2025-05-17 11:19:22,491 - websocket_server - INFO - Nh·∫≠n tin nh·∫Øn d·∫°ng JSON: {"content":"alo /no_think","session_id":""}
2025-05-17 11:19:22,492 - websocket_server - INFO - Session ID kh√¥ng ƒë∆∞·ª£c cung c·∫•p trong tin nh·∫Øn JSON, s·ª≠ d·ª•ng current_session_id: 16b1f3ea-b548-4dc1-91ef-f517c74092b7
2025-05-17 11:19:22,492 - websocket_server - INFO - Session ID t·ª´ client (sau khi ki·ªÉm tra): 16b1f3ea-b548-4dc1-91ef-f517c74092b7
2025-05-17 11:19:22,493 - websocket_server - INFO - T·∫Øt ch·∫ø ƒë·ªô thinking cho c√¢u h·ªèi: alo /no_think...
2025-05-17 11:19:22,493 - websocket_server - INFO - Nh·∫≠n tin nh·∫Øn th√¥ng th∆∞·ªùng: alo /no_think, enable_thinking=False
2025-05-17 11:19:22,493 - websocket_server - INFO - ƒê√£ th√™m 1 tin nh·∫Øn g·∫ßn nh·∫•t v√†o prompt
2025-05-17 11:19:22,495 - websocket_server - INFO - ƒê√£ l∆∞u l·ªãch s·ª≠ tin nh·∫Øn v√† prompt v√†o file: data/logs/history_prompt_20250517_111922.txt
2025-05-17 11:19:22,496 - websocket_server - INFO - Ph√¢n t√≠ch c√¢u h·ªèi: Ph√≤ng ban=None, Lo·∫°i=general, Thinking=False
2025-05-17 11:19:22,496 - websocket_server - INFO - X·ª≠ l√Ω streaming response cho: 'alo /no_think', ph√≤ng ban: None, session_id: 16b1f3ea-b548-4dc1-91ef-f517c74092b7
2025-05-17 11:19:22,497 - websocket_server - INFO - Session ID nh·∫≠n ƒë∆∞·ª£c: 16b1f3ea-b548-4dc1-91ef-f517c74092b7
2025-05-17 11:19:22,497 - websocket_server - INFO - Ph√°t hi·ªán l·ªánh /no_think, t·∫Øt ch·∫ø ƒë·ªô thinking cho: alo
2025-05-17 11:19:22,497 - websocket_server - INFO - X·ª≠ l√Ω streaming response. Query: 'alo', Mode thinking: False
2025-05-17 11:19:22,498 - websocket_server - INFO - ƒê√£ th√™m 1 tin nh·∫Øn g·∫ßn nh·∫•t v√†o prompt
2025-05-17 11:19:22,499 - websocket_server - INFO - ƒê√£ l∆∞u l·ªãch s·ª≠ tin nh·∫Øn v√† prompt v√†o file: data/logs/history_prompt_20250517_111922.txt
2025-05-17 11:19:22,499 - websocket_server - INFO - Ph√¢n t√≠ch c√¢u h·ªèi: Ph√≤ng ban=None, Lo·∫°i=general, Thinking=False
2025-05-17 11:19:22,499 - websocket_server - INFO - Query th·ª±c t·∫ø g·ª≠i ƒë·∫øn m√¥ h√¨nh: alo /no_think
2025-05-17 11:19:22,500 - websocket_server - INFO - C√¢u h·ªèi chung, ch·∫ø ƒë·ªô thinking: False
2025-05-17 11:19:22,500 - websocket_server - INFO - ƒê√£ l∆∞u h·ªôi tho·∫°i chung v√†o l·ªãch s·ª≠ c·ªßa session 16b1f3ea-b548-4dc1-91ef-f517c74092b7
2025-05-17 11:19:24,785 - websocket_server - WARNING - Session  kh√¥ng t·ªìn t·∫°i, s·ª≠ d·ª•ng session hi·ªán t·∫°i
2025-05-17 11:19:24,785 - websocket_server - INFO - Nh·∫≠n y√™u c·∫ßu ph√¢n t√≠ch (thinking) cho c√¢u h·ªèi: Mock response for general query: alo /no_think
2025-05-17 11:19:24,786 - websocket_server - INFO - ƒê√£ th√™m 2 tin nh·∫Øn g·∫ßn nh·∫•t v√†o prompt
2025-05-17 11:19:24,787 - websocket_server - INFO - ƒê√£ l∆∞u l·ªãch s·ª≠ tin nh·∫Øn v√† prompt v√†o file: data/logs/history_prompt_20250517_111924.txt
2025-05-17 11:19:24,787 - websocket_server - INFO - Ph√¢n t√≠ch c√¢u h·ªèi ƒë·ªÉ x√°c ƒë·ªãnh ph√≤ng ban ho·∫∑c lo·∫°i c√¢u h·ªèi
2025-05-17 11:19:24,788 - websocket_server - INFO - L·∫•y ph√¢n t√≠ch cho c√¢u h·ªèi chung
2025-05-17 11:19:24,788 - websocket_server - INFO - G·ª≠i ph·∫£n h·ªìi thinking v·ªõi request_id: thinking_1747455564784_zgioz0p
2025-05-17 11:19:24,789 - websocket_server - INFO - ƒê√£ g·ª≠i n·ªôi dung thinking (304 k√Ω t·ª±)
2025-05-17 11:21:28,193 - websockets.server - INFO - server closing
2025-05-17 11:21:28,256 - websockets.server - INFO - server closed
2025-05-17 11:21:28,257 - websocket_server - INFO - Server b·ªã d·ª´ng b·ªüi ng∆∞·ªùi d√πng
2025-05-17 11:21:30,523 - websocket_server - INFO - Kh·ªüi ƒë·ªông server WebSocket t·∫°i 0.0.0.0:8090
2025-05-17 11:21:30,558 - websockets.server - INFO - server listening on 0.0.0.0:8090
2025-05-17 11:21:30,558 - websocket_server - INFO - Server WebSocket ƒëang ch·∫°y t·∫°i ws://0.0.0.0:8090
2025-05-17 11:21:30,558 - websocket_server - INFO - ƒê√£ c·∫•u h√¨nh ping_timeout=6000 gi√¢y, ping_interval=60 gi√¢y
2025-05-17 11:23:52,845 - websockets.server - INFO - connection open
2025-05-17 11:23:53,834 - websocket_server - INFO - Nh·∫≠n tin nh·∫Øn d·∫°ng JSON: {"content":"alo /no_think","session_id":""}
2025-05-17 11:23:53,834 - websocket_server - INFO - Session ID kh√¥ng ƒë∆∞·ª£c cung c·∫•p trong tin nh·∫Øn JSON, s·ª≠ d·ª•ng current_session_id: d16ec270-a709-41a4-bfe8-5f693a828ea5
2025-05-17 11:23:53,834 - websocket_server - INFO - Session ID t·ª´ client (sau khi ki·ªÉm tra): d16ec270-a709-41a4-bfe8-5f693a828ea5
2025-05-17 11:23:53,835 - websocket_server - INFO - T·∫Øt ch·∫ø ƒë·ªô thinking cho c√¢u h·ªèi: alo /no_think...
2025-05-17 11:23:53,835 - websocket_server - INFO - Nh·∫≠n tin nh·∫Øn th√¥ng th∆∞·ªùng: alo /no_think, enable_thinking=False
2025-05-17 11:23:53,835 - websocket_server - INFO - Kh√¥ng c√≥ l·ªãch s·ª≠ tin nh·∫Øn cho phi√™n n√†y
2025-05-17 11:23:53,835 - chatbot_rag - INFO - ƒêang ph√¢n t√≠ch c√¢u h·ªèi v·ªõi LLM: alo /no_think, session_id: d16ec270-a709-41a4-bfe8-5f693a828ea5
2025-05-17 11:23:53,837 - chatbot_rag - WARNING - [analyze_query_with_llm] Kh√¥ng th·ªÉ import get_session_history t·ª´ websocket_server, s·ª≠ d·ª•ng get_chat_history
2025-05-17 11:23:53,838 - chatbot_rag - INFO - [analyze_query_with_llm] L·∫•y l·ªãch s·ª≠ t·ª´ get_chat_history: 0 b·∫£n ghi
2025-05-17 11:23:53,838 - chatbot_rag - INFO - [analyze_query_with_llm] S·ª≠ d·ª•ng l·ªãch s·ª≠ h·ªôi tho·∫°i: 0 b·∫£n ghi
2025-05-17 11:23:53,839 - chatbot_rag - INFO - [analyze_query_with_llm] Prompt cu·ªëi c√πng: L·ªãch s·ª≠ tin nh·∫Øn:

C√¢u h·ªèi ng∆∞·ªùi d√πng hi·ªán t·∫°i: "alo /no_think"

Ph√¢n t√≠ch c√¢u h·ªèi v√† tr·∫£ v·ªÅ JSON c√≥ ƒë·ªãnh d·∫°ng:
{"department": "t√™n ph√≤ng ban ho·∫∑c null", "query_type": "department_specific ho·∫∑c genera...
2025-05-17 11:23:53,839 - chatbot_rag - INFO - K√≠ch th∆∞·ªõc prompt: 486 k√Ω t·ª±
2025-05-17 11:23:53,839 - chatbot_rag - INFO - K√≠ch th∆∞·ªõc system prompt: 4181 k√Ω t·ª±
2025-05-17 11:23:53,839 - chatbot_rag - INFO - T·ªïng k√≠ch th∆∞·ªõc: 4667 k√Ω t·ª±
2025-05-17 11:23:53,841 - chatbot_rag - INFO - ƒê√£ l∆∞u full prompt v√†o file: data/logs/llm_full_prompt_20250517_112353.txt
2025-05-17 11:23:53,842 - chatbot_rag - INFO - System prompt: 
B·∫°n l√† tr·ª£ l√Ω AI chuy√™n ph√¢n t√≠ch n·ªôi dung c√¢u h·ªèi ƒë·ªÉ x√°c ƒë·ªãnh:
1. Ph√≤ng ban m√† ng∆∞·ªùi d√πng ƒëang h·ªèi v·ªÅ (department)
2. Ph√¢n lo·∫°i c√¢u h·ªèi l√† v·ªÅ ph√≤ng ban c·ª• th·ªÉ hay c√¢u h·ªèi chung (query_type)
3. X√°c ƒë...
2025-05-17 11:23:53,842 - chatbot_rag - INFO - User prompt: L·ªãch s·ª≠ tin nh·∫Øn:

C√¢u h·ªèi ng∆∞·ªùi d√πng hi·ªán t·∫°i: "alo /no_think"

Ph√¢n t√≠ch c√¢u h·ªèi v√† tr·∫£ v·ªÅ JSON c√≥ ƒë·ªãnh d·∫°ng:
{"department": "t√™n ph√≤ng ban ho·∫∑c null", "query_type": "department_specific ho·∫∑c genera...
2025-05-17 11:23:53,843 - chatbot_rag - INFO - G·ª≠i truy v·∫•n ƒë·∫øn LLM API t·∫°i http://localhost:1234/v1/chat/completions v·ªõi stream=False
2025-05-17 11:24:07,324 - chatbot_rag - INFO - M√£ ph·∫£n h·ªìi t·ª´ API: 200
2025-05-17 11:24:07,325 - chatbot_rag - INFO - Ph·∫£n h·ªìi g·ªëc t·ª´ LLM API (200 k√Ω t·ª± ƒë·∫ßu): <think>

</think>

{"department": "Kinh doanh", "query_type": "department_specific", "error": false}
2025-05-17 11:24:07,330 - chatbot_rag - INFO - ƒê√£ l∆∞u ph·∫£n h·ªìi ƒë·∫ßy ƒë·ªß v√†o file: data/logs/llm_response_20250517_112407.txt
2025-05-17 11:24:07,334 - chatbot_rag - INFO - [analysis_20250517_112407] ƒê√£ ghi ph·∫£n h·ªìi g·ªëc v√†o: data/logs/analysis_20250517_112407_raw.txt
2025-05-17 11:24:07,335 - chatbot_rag - INFO - [analysis_20250517_112407] Ph·∫£n h·ªìi g·ªëc: <think>

</think>

{"department": "Kinh doanh", "query_type": "department_specific", "error": false}...
2025-05-17 11:24:07,335 - chatbot_rag - WARNING - [analysis_20250517_112407] Ph√°t hi·ªán th·∫ª <think> trong ph·∫£n h·ªìi. X·ª≠ l√Ω ƒë·∫∑c bi·ªát...
2025-05-17 11:24:07,336 - chatbot_rag - INFO - [analysis_20250517_112407] ƒê√£ t√¨m th·∫•y 1 m·∫´u JSON ti·ªÅm nƒÉng trong ph·∫£n h·ªìi
2025-05-17 11:24:07,337 - chatbot_rag - INFO - [analysis_20250517_112407] T√¨m th·∫•y JSON h·ª£p l·ªá trong th·∫ª <think>: {'department': 'Kinh doanh', 'query_type': 'department_specific', 'error': False}
2025-05-17 11:24:07,337 - websocket_server - INFO - Ph√¢n t√≠ch c√¢u h·ªèi: Ph√≤ng ban=Kinh doanh, Lo·∫°i=department_specific, Thinking=False
2025-05-17 11:24:07,338 - websocket_server - INFO - X·ª≠ l√Ω streaming response cho: 'alo /no_think', ph√≤ng ban: Kinh doanh, session_id: d16ec270-a709-41a4-bfe8-5f693a828ea5
2025-05-17 11:24:07,338 - websocket_server - INFO - Session ID nh·∫≠n ƒë∆∞·ª£c: d16ec270-a709-41a4-bfe8-5f693a828ea5
2025-05-17 11:24:07,339 - websocket_server - INFO - Ph√°t hi·ªán l·ªánh /no_think, t·∫Øt ch·∫ø ƒë·ªô thinking cho: alo
2025-05-17 11:24:07,339 - websocket_server - INFO - X·ª≠ l√Ω streaming response. Query: 'alo', Mode thinking: False
2025-05-17 11:24:07,341 - websocket_server - INFO - Kh√¥ng c√≥ l·ªãch s·ª≠ tin nh·∫Øn cho phi√™n n√†y
2025-05-17 11:24:07,341 - websocket_server - INFO - Ph√¢n t√≠ch c√¢u h·ªèi: Ph√≤ng ban=Kinh doanh, Lo·∫°i=department_specific, Thinking=False
2025-05-17 11:24:07,342 - websocket_server - INFO - Query th·ª±c t·∫ø g·ª≠i ƒë·∫øn m√¥ h√¨nh: alo /no_think
2025-05-17 11:24:07,342 - websocket_server - INFO - C√¢u h·ªèi v·ªÅ ph√≤ng ban c·ª• th·ªÉ: Kinh doanh, ch·∫ø ƒë·ªô thinking: False
2025-05-17 11:24:07,342 - chatbot_rag - INFO - Truy v·∫•n Smart RAG - Giai ƒëo·∫°n: None, Ph√≤ng ban: Kinh doanh, Session: d16ec270-a709-41a4-bfe8-5f693a828ea5
2025-05-17 11:24:07,356 - department_info_tool - INFO - ƒê√£ t·∫£i 11 ph√≤ng ban
2025-05-17 11:24:07,357 - department_info_tool - INFO - ƒêang tr√≠ch xu·∫•t th√¥ng tin cho ph√≤ng ban: Kinh doanh
2025-05-17 11:24:07,358 - department_info_tool - INFO - ƒê√£ ƒë·ªçc th√†nh c√¥ng file C:\Users\thuon\OneDrive\Desktop\test\chatbot_qwen\docker_build\data\departments\kinh_doanh.txt, k√≠ch th∆∞·ªõc: 16485 bytes
2025-05-17 11:24:07,379 - department_info_tool - INFO - ƒê√£ t√¨m th·∫•y 5 giai ƒëo·∫°n v√† 24 c√¥ng vi·ªác cho ph√≤ng ban Kinh doanh
2025-05-17 11:24:07,379 - chatbot_rag - INFO - T·∫°o prompt LLM cho ph√≤ng ban: Kinh doanh, session_id: d16ec270-a709-41a4-bfe8-5f693a828ea5
2025-05-17 11:24:07,380 - chatbot_rag - INFO - S·ªë task: 24
2025-05-17 11:24:07,380 - chatbot_rag - INFO - L·∫•y l·ªãch s·ª≠ h·ªôi tho·∫°i t·ª´ phi√™n d16ec270-a709-41a4-bfe8-5f693a828ea5
2025-05-17 11:24:07,381 - chatbot_rag - WARNING - [create_llm_prompt] Kh√¥ng th·ªÉ import get_session_history t·ª´ websocket_server. Th·ª≠ get_chat_history (c·ª•c b·ªô).
2025-05-17 11:24:07,381 - chatbot_rag - INFO - [create_llm_prompt] ƒê√£ l·∫•y ƒë∆∞·ª£c 0 b·∫£n ghi l·ªãch s·ª≠ t·ª´ get_chat_history (c·ª•c b·ªô).
2025-05-17 11:24:07,384 - chatbot_rag - INFO - G·ªçi LLM:  t·∫°i 
2025-05-17 11:24:07,386 - chatbot_rag - INFO - ƒê√£ l∆∞u prompt v√†o file: data/logs/prompt_20250517_112407.txt
2025-05-17 11:24:07,387 - chatbot_rag - INFO - K√≠ch th∆∞·ªõc prompt: 12219 k√Ω t·ª±
2025-05-17 11:24:07,387 - chatbot_rag - INFO - K√≠ch th∆∞·ªõc system prompt: 2631 k√Ω t·ª±
2025-05-17 11:24:07,387 - chatbot_rag - INFO - T·ªïng k√≠ch th∆∞·ªõc: 14850 k√Ω t·ª±
2025-05-17 11:24:07,389 - chatbot_rag - INFO - ƒê√£ l∆∞u full prompt v√†o file: data/logs/llm_full_prompt_20250517_112407.txt
2025-05-17 11:24:07,389 - chatbot_rag - INFO - System prompt: 
B·∫°n l√† tr·ª£ l√Ω AI chuy√™n v·ªÅ c√¥ng vi·ªác c·ªßa c√°c ph√≤ng ban trong c√¥ng ty. 
Nhi·ªám v·ª• c·ªßa b·∫°n l√† ph√¢n t√≠ch th√¥ng tin v·ªÅ c√°c task trong ph√≤ng ban v√† cung c·∫•p th√¥ng tin h·ªØu √≠ch cho ng∆∞·ªùi d√πng.

D·ª± √°n ƒë∆∞·ª£c ch...
2025-05-17 11:24:07,390 - chatbot_rag - INFO - User prompt: 
Vai tr√≤ c·ªßa b·∫°n: Tr·ª£ l√Ω th√¥ng minh cung c·∫•p th√¥ng tin v·ªÅ ph√≤ng ban v√† c√¥ng vi·ªác trong c√¥ng ty.


C√¢u h·ªèi ng∆∞·ªùi d√πng hi·ªán t·∫°i: "alo /no_think"

Th√¥ng tin v·ªÅ ph√≤ng ban Kinh doanh:
S·ªë l∆∞·ª£ng tasks: 24
C√°...
2025-05-17 11:24:07,390 - chatbot_rag - INFO - G·ª≠i truy v·∫•n ƒë·∫øn LLM API t·∫°i http://localhost:1234/v1/chat/completions v·ªõi stream=True
2025-05-17 11:24:51,101 - chatbot_rag - INFO - M√£ ph·∫£n h·ªìi t·ª´ API: 200
2025-05-17 11:24:51,102 - chatbot_rag - INFO - Ph·∫£n h·ªìi g·ªëc t·ª´ LLM API (200 k√Ω t·ª± ƒë·∫ßu): <think>

</think>

**Alo!** üòÑ  
B·∫°n ƒëang c·∫ßn th√¥ng tin g√¨ v·ªÅ ph√≤ng ban **Kinh doanh**? M√¨nh s·∫µn s√†ng h·ªó tr·ª£ b·∫°n ngay l·∫≠p t·ª©c nh√©! N·∫øu b·∫°n mu·ªën bi·∫øt chi ti·∫øt v·ªÅ c√°c task, giai ƒëo·∫°n ho·∫∑c quy tr√¨nh li√™n 
2025-05-17 11:24:51,104 - chatbot_rag - INFO - ƒê√£ l∆∞u ph·∫£n h·ªìi ƒë·∫ßy ƒë·ªß v√†o file: data/logs/llm_response_20250517_112451.txt
2025-05-17 11:24:51,106 - chatbot_rag - INFO - ƒê√£ l∆∞u response v√†o file: data/logs/response_20250517_112407.txt
2025-05-17 11:24:51,106 - chatbot_rag - INFO - Th·ªùi gian truy v·∫•n LLM: 43.75 gi√¢y
2025-05-17 11:24:51,700 - department_info_tool - INFO - ƒêang tr√≠ch xu·∫•t th√¥ng tin cho ph√≤ng ban: Kinh doanh
2025-05-17 11:24:51,701 - department_info_tool - INFO - ƒê√£ ƒë·ªçc th√†nh c√¥ng file C:\Users\thuon\OneDrive\Desktop\test\chatbot_qwen\docker_build\data\departments\kinh_doanh.txt, k√≠ch th∆∞·ªõc: 16485 bytes
2025-05-17 11:24:51,703 - department_info_tool - INFO - ƒê√£ t√¨m th·∫•y 5 giai ƒëo·∫°n v√† 24 c√¥ng vi·ªác cho ph√≤ng ban Kinh doanh
2025-05-17 11:24:55,500 - websocket_server - INFO - ƒê√£ tr√≠ch xu·∫•t thinking (0 k√Ω t·ª±) v√† c√≤n l·∫°i 218 k√Ω t·ª± ph·∫£n h·ªìi
2025-05-17 11:24:55,501 - websocket_server - INFO - ƒê√£ tr√≠ch xu·∫•t ph·∫ßn thinking (0 k√Ω t·ª±) t·ª´ ph·∫£n h·ªìi
2025-05-17 11:24:55,501 - websocket_server - INFO - ƒê√£ l∆∞u h·ªôi tho·∫°i ph√≤ng ban Kinh doanh v√†o l·ªãch s·ª≠ c·ªßa session d16ec270-a709-41a4-bfe8-5f693a828ea5
2025-05-17 11:25:55,751 - websockets.server - INFO - connection open
2025-05-17 11:29:12,047 - websockets.server - INFO - connection open
2025-05-17 11:43:10,391 - websockets.server - INFO - connection open
2025-05-17 11:43:25,110 - websocket_server - INFO - Nh·∫≠n tin nh·∫Øn d·∫°ng JSON: {"content":"alo /no_think","session_id":"cf6e5d85-f403-4c4d-8afc-06ff092bdf8c"}
2025-05-17 11:43:25,110 - websocket_server - INFO - Session ID t·ª´ client (sau khi ki·ªÉm tra): cf6e5d85-f403-4c4d-8afc-06ff092bdf8c
2025-05-17 11:43:25,111 - websocket_server - INFO - T·∫Øt ch·∫ø ƒë·ªô thinking cho c√¢u h·ªèi: alo /no_think...
2025-05-17 11:43:25,112 - websocket_server - INFO - Nh·∫≠n tin nh·∫Øn th√¥ng th∆∞·ªùng: alo /no_think, enable_thinking=False
2025-05-17 11:43:25,112 - websocket_server - INFO - Kh√¥ng c√≥ l·ªãch s·ª≠ tin nh·∫Øn cho phi√™n n√†y
2025-05-17 11:43:25,113 - chatbot_rag - INFO - ƒêang ph√¢n t√≠ch c√¢u h·ªèi v·ªõi LLM: alo /no_think, session_id: cf6e5d85-f403-4c4d-8afc-06ff092bdf8c
2025-05-17 11:43:25,117 - chatbot_rag - WARNING - [analyze_query_with_llm] Kh√¥ng th·ªÉ import get_session_history t·ª´ websocket_server, s·ª≠ d·ª•ng get_chat_history
2025-05-17 11:43:25,121 - chatbot_rag - INFO - [analyze_query_with_llm] L·∫•y l·ªãch s·ª≠ t·ª´ get_chat_history: 0 b·∫£n ghi
2025-05-17 11:43:25,121 - chatbot_rag - INFO - [analyze_query_with_llm] S·ª≠ d·ª•ng l·ªãch s·ª≠ h·ªôi tho·∫°i: 0 b·∫£n ghi
2025-05-17 11:43:25,122 - chatbot_rag - INFO - [analyze_query_with_llm] Prompt cu·ªëi c√πng: L·ªãch s·ª≠ tin nh·∫Øn:

C√¢u h·ªèi ng∆∞·ªùi d√πng hi·ªán t·∫°i: "alo /no_think"

Ph√¢n t√≠ch c√¢u h·ªèi v√† tr·∫£ v·ªÅ JSON c√≥ ƒë·ªãnh d·∫°ng:
{"department": "t√™n ph√≤ng ban ho·∫∑c null", "query_type": "department_specific ho·∫∑c genera...
2025-05-17 11:43:25,123 - chatbot_rag - INFO - K√≠ch th∆∞·ªõc prompt: 486 k√Ω t·ª±
2025-05-17 11:43:25,124 - chatbot_rag - INFO - K√≠ch th∆∞·ªõc system prompt: 4181 k√Ω t·ª±
2025-05-17 11:43:25,124 - chatbot_rag - INFO - T·ªïng k√≠ch th∆∞·ªõc: 4667 k√Ω t·ª±
2025-05-17 11:43:25,129 - chatbot_rag - INFO - ƒê√£ l∆∞u full prompt v√†o file: data/logs/llm_full_prompt_20250517_114325.txt
2025-05-17 11:43:25,130 - chatbot_rag - INFO - System prompt: 
B·∫°n l√† tr·ª£ l√Ω AI chuy√™n ph√¢n t√≠ch n·ªôi dung c√¢u h·ªèi ƒë·ªÉ x√°c ƒë·ªãnh:
1. Ph√≤ng ban m√† ng∆∞·ªùi d√πng ƒëang h·ªèi v·ªÅ (department)
2. Ph√¢n lo·∫°i c√¢u h·ªèi l√† v·ªÅ ph√≤ng ban c·ª• th·ªÉ hay c√¢u h·ªèi chung (query_type)
3. X√°c ƒë...
2025-05-17 11:43:25,130 - chatbot_rag - INFO - User prompt: L·ªãch s·ª≠ tin nh·∫Øn:

C√¢u h·ªèi ng∆∞·ªùi d√πng hi·ªán t·∫°i: "alo /no_think"

Ph√¢n t√≠ch c√¢u h·ªèi v√† tr·∫£ v·ªÅ JSON c√≥ ƒë·ªãnh d·∫°ng:
{"department": "t√™n ph√≤ng ban ho·∫∑c null", "query_type": "department_specific ho·∫∑c genera...
2025-05-17 11:43:25,131 - chatbot_rag - INFO - G·ª≠i truy v·∫•n ƒë·∫øn LLM API t·∫°i http://localhost:1234/v1/chat/completions v·ªõi stream=False
2025-05-17 11:43:38,245 - chatbot_rag - INFO - M√£ ph·∫£n h·ªìi t·ª´ API: 200
2025-05-17 11:43:38,246 - chatbot_rag - INFO - Ph·∫£n h·ªìi g·ªëc t·ª´ LLM API (200 k√Ω t·ª± ƒë·∫ßu): <think>

</think>

{"department": "Kinh doanh", "query_type": "department_specific", "error": false}
2025-05-17 11:43:38,247 - chatbot_rag - INFO - ƒê√£ l∆∞u ph·∫£n h·ªìi ƒë·∫ßy ƒë·ªß v√†o file: data/logs/llm_response_20250517_114338.txt
2025-05-17 11:43:38,249 - chatbot_rag - INFO - [analysis_20250517_114338] ƒê√£ ghi ph·∫£n h·ªìi g·ªëc v√†o: data/logs/analysis_20250517_114338_raw.txt
2025-05-17 11:43:38,249 - chatbot_rag - INFO - [analysis_20250517_114338] Ph·∫£n h·ªìi g·ªëc: <think>

</think>

{"department": "Kinh doanh", "query_type": "department_specific", "error": false}...
2025-05-17 11:43:38,250 - chatbot_rag - WARNING - [analysis_20250517_114338] Ph√°t hi·ªán th·∫ª <think> trong ph·∫£n h·ªìi. X·ª≠ l√Ω ƒë·∫∑c bi·ªát...
2025-05-17 11:43:38,250 - chatbot_rag - INFO - [analysis_20250517_114338] ƒê√£ t√¨m th·∫•y 1 m·∫´u JSON ti·ªÅm nƒÉng trong ph·∫£n h·ªìi
2025-05-17 11:43:38,251 - chatbot_rag - INFO - [analysis_20250517_114338] T√¨m th·∫•y JSON h·ª£p l·ªá trong th·∫ª <think>: {'department': 'Kinh doanh', 'query_type': 'department_specific', 'error': False}
2025-05-17 11:43:38,251 - websocket_server - INFO - Ph√¢n t√≠ch c√¢u h·ªèi: Ph√≤ng ban=Kinh doanh, Lo·∫°i=department_specific, Thinking=False
2025-05-17 11:43:38,252 - websocket_server - INFO - X·ª≠ l√Ω streaming response cho: 'alo /no_think', ph√≤ng ban: Kinh doanh, session_id: cf6e5d85-f403-4c4d-8afc-06ff092bdf8c
2025-05-17 11:43:38,252 - websocket_server - INFO - Session ID nh·∫≠n ƒë∆∞·ª£c: cf6e5d85-f403-4c4d-8afc-06ff092bdf8c
2025-05-17 11:43:38,252 - websocket_server - INFO - Ph√°t hi·ªán l·ªánh /no_think, t·∫Øt ch·∫ø ƒë·ªô thinking cho: alo
2025-05-17 11:43:38,253 - websocket_server - INFO - X·ª≠ l√Ω streaming response. Query: 'alo', Mode thinking: False
2025-05-17 11:43:38,253 - websocket_server - INFO - Kh√¥ng c√≥ l·ªãch s·ª≠ tin nh·∫Øn cho phi√™n n√†y
2025-05-17 11:43:38,253 - websocket_server - INFO - Ph√¢n t√≠ch c√¢u h·ªèi: Ph√≤ng ban=Kinh doanh, Lo·∫°i=department_specific, Thinking=False
2025-05-17 11:43:38,254 - websocket_server - INFO - Query th·ª±c t·∫ø g·ª≠i ƒë·∫øn m√¥ h√¨nh: alo /no_think
2025-05-17 11:43:38,254 - websocket_server - INFO - C√¢u h·ªèi v·ªÅ ph√≤ng ban c·ª• th·ªÉ: Kinh doanh, ch·∫ø ƒë·ªô thinking: False
2025-05-17 11:43:38,254 - chatbot_rag - INFO - Truy v·∫•n Smart RAG - Giai ƒëo·∫°n: None, Ph√≤ng ban: Kinh doanh, Session: cf6e5d85-f403-4c4d-8afc-06ff092bdf8c
2025-05-17 11:43:38,264 - department_info_tool - INFO - ƒê√£ t·∫£i 11 ph√≤ng ban
2025-05-17 11:43:38,266 - department_info_tool - INFO - ƒêang tr√≠ch xu·∫•t th√¥ng tin cho ph√≤ng ban: Kinh doanh
2025-05-17 11:43:38,267 - department_info_tool - INFO - ƒê√£ ƒë·ªçc th√†nh c√¥ng file C:\Users\thuon\OneDrive\Desktop\test\chatbot_qwen\docker_build\data\departments\kinh_doanh.txt, k√≠ch th∆∞·ªõc: 16485 bytes
2025-05-17 11:43:38,272 - department_info_tool - INFO - ƒê√£ t√¨m th·∫•y 5 giai ƒëo·∫°n v√† 24 c√¥ng vi·ªác cho ph√≤ng ban Kinh doanh
2025-05-17 11:43:38,273 - chatbot_rag - INFO - T·∫°o prompt LLM cho ph√≤ng ban: Kinh doanh, session_id: cf6e5d85-f403-4c4d-8afc-06ff092bdf8c
2025-05-17 11:43:38,274 - chatbot_rag - INFO - S·ªë task: 24
2025-05-17 11:43:38,274 - chatbot_rag - INFO - L·∫•y l·ªãch s·ª≠ h·ªôi tho·∫°i t·ª´ phi√™n cf6e5d85-f403-4c4d-8afc-06ff092bdf8c
2025-05-17 11:43:38,275 - chatbot_rag - WARNING - [create_llm_prompt] Kh√¥ng th·ªÉ import get_session_history t·ª´ websocket_server. Th·ª≠ get_chat_history (c·ª•c b·ªô).
2025-05-17 11:43:38,276 - chatbot_rag - INFO - [create_llm_prompt] ƒê√£ l·∫•y ƒë∆∞·ª£c 0 b·∫£n ghi l·ªãch s·ª≠ t·ª´ get_chat_history (c·ª•c b·ªô).
2025-05-17 11:43:38,280 - chatbot_rag - INFO - G·ªçi LLM:  t·∫°i 
2025-05-17 11:43:38,283 - chatbot_rag - INFO - ƒê√£ l∆∞u prompt v√†o file: data/logs/prompt_20250517_114338.txt
2025-05-17 11:43:38,283 - chatbot_rag - INFO - K√≠ch th∆∞·ªõc prompt: 12219 k√Ω t·ª±
2025-05-17 11:43:38,284 - chatbot_rag - INFO - K√≠ch th∆∞·ªõc system prompt: 2631 k√Ω t·ª±
2025-05-17 11:43:38,284 - chatbot_rag - INFO - T·ªïng k√≠ch th∆∞·ªõc: 14850 k√Ω t·ª±
2025-05-17 11:43:38,287 - chatbot_rag - INFO - ƒê√£ l∆∞u full prompt v√†o file: data/logs/llm_full_prompt_20250517_114338.txt
2025-05-17 11:43:38,287 - chatbot_rag - INFO - System prompt: 
B·∫°n l√† tr·ª£ l√Ω AI chuy√™n v·ªÅ c√¥ng vi·ªác c·ªßa c√°c ph√≤ng ban trong c√¥ng ty. 
Nhi·ªám v·ª• c·ªßa b·∫°n l√† ph√¢n t√≠ch th√¥ng tin v·ªÅ c√°c task trong ph√≤ng ban v√† cung c·∫•p th√¥ng tin h·ªØu √≠ch cho ng∆∞·ªùi d√πng.

D·ª± √°n ƒë∆∞·ª£c ch...
2025-05-17 11:43:38,287 - chatbot_rag - INFO - User prompt: 
Vai tr√≤ c·ªßa b·∫°n: Tr·ª£ l√Ω th√¥ng minh cung c·∫•p th√¥ng tin v·ªÅ ph√≤ng ban v√† c√¥ng vi·ªác trong c√¥ng ty.


C√¢u h·ªèi ng∆∞·ªùi d√πng hi·ªán t·∫°i: "alo /no_think"

Th√¥ng tin v·ªÅ ph√≤ng ban Kinh doanh:
S·ªë l∆∞·ª£ng tasks: 24
C√°...
2025-05-17 11:43:38,288 - chatbot_rag - INFO - G·ª≠i truy v·∫•n ƒë·∫øn LLM API t·∫°i http://localhost:1234/v1/chat/completions v·ªõi stream=True
2025-05-17 11:44:21,342 - chatbot_rag - INFO - M√£ ph·∫£n h·ªìi t·ª´ API: 200
2025-05-17 11:44:21,344 - chatbot_rag - INFO - Ph·∫£n h·ªìi g·ªëc t·ª´ LLM API (200 k√Ω t·ª± ƒë·∫ßu): <think>

</think>

**Alo!** üéâ  
T√¥i ƒë√¢y, b·∫°n mu·ªën bi·∫øt g√¨ v·ªÅ ph√≤ng ban **Kinh doanh** v√† c√°c giai ƒëo·∫°n li√™n quan? D√π l√† task, m·ª•c ti√™u hay quy tr√¨nh, m√¨nh s·∫Ω gi·∫£i th√≠ch r√µ r√†ng cho b·∫°n nh√©! üíº‚ú®
2025-05-17 11:44:21,346 - chatbot_rag - INFO - ƒê√£ l∆∞u ph·∫£n h·ªìi ƒë·∫ßy ƒë·ªß v√†o file: data/logs/llm_response_20250517_114421.txt
2025-05-17 11:44:21,348 - chatbot_rag - INFO - ƒê√£ l∆∞u response v√†o file: data/logs/response_20250517_114338.txt
2025-05-17 11:44:21,349 - chatbot_rag - INFO - Th·ªùi gian truy v·∫•n LLM: 43.08 gi√¢y
2025-05-17 11:44:21,358 - department_info_tool - INFO - ƒêang tr√≠ch xu·∫•t th√¥ng tin cho ph√≤ng ban: Kinh doanh
2025-05-17 11:44:21,359 - department_info_tool - INFO - ƒê√£ ƒë·ªçc th√†nh c√¥ng file C:\Users\thuon\OneDrive\Desktop\test\chatbot_qwen\docker_build\data\departments\kinh_doanh.txt, k√≠ch th∆∞·ªõc: 16485 bytes
2025-05-17 11:44:21,363 - department_info_tool - INFO - ƒê√£ t√¨m th·∫•y 5 giai ƒëo·∫°n v√† 24 c√¥ng vi·ªác cho ph√≤ng ban Kinh doanh
2025-05-17 11:44:21,371 - websocket_server - INFO - ƒê√£ tr√≠ch xu·∫•t thinking (0 k√Ω t·ª±) v√† c√≤n l·∫°i 173 k√Ω t·ª± ph·∫£n h·ªìi
2025-05-17 11:44:21,372 - websocket_server - INFO - ƒê√£ tr√≠ch xu·∫•t ph·∫ßn thinking (0 k√Ω t·ª±) t·ª´ ph·∫£n h·ªìi
2025-05-17 11:44:21,372 - websocket_server - INFO - ƒê√£ l∆∞u h·ªôi tho·∫°i ph√≤ng ban Kinh doanh v√†o l·ªãch s·ª≠ c·ªßa session cf6e5d85-f403-4c4d-8afc-06ff092bdf8c
2025-05-17 11:45:53,285 - websockets.server - INFO - connection open
2025-05-17 11:46:04,838 - websocket_server - INFO - Nh·∫≠n tin nh·∫Øn d·∫°ng JSON: {"content":"alo /think","session_id":"284b52f9-dae0-4001-98fc-1e425fa03bf9"}
2025-05-17 11:46:04,839 - websocket_server - INFO - Session ID t·ª´ client (sau khi ki·ªÉm tra): 284b52f9-dae0-4001-98fc-1e425fa03bf9
2025-05-17 11:46:04,839 - websocket_server - INFO - B·∫≠t ch·∫ø ƒë·ªô thinking cho c√¢u h·ªèi: alo /think...
2025-05-17 11:46:04,839 - websocket_server - INFO - Nh·∫≠n tin nh·∫Øn th√¥ng th∆∞·ªùng: alo /think, enable_thinking=True
2025-05-17 11:46:04,840 - websocket_server - INFO - Kh√¥ng c√≥ l·ªãch s·ª≠ tin nh·∫Øn cho phi√™n n√†y
2025-05-17 11:46:04,840 - chatbot_rag - INFO - ƒêang ph√¢n t√≠ch c√¢u h·ªèi v·ªõi LLM: alo /think, session_id: 284b52f9-dae0-4001-98fc-1e425fa03bf9
2025-05-17 11:46:04,842 - chatbot_rag - WARNING - [analyze_query_with_llm] Kh√¥ng th·ªÉ import get_session_history t·ª´ websocket_server, s·ª≠ d·ª•ng get_chat_history
2025-05-17 11:46:04,843 - chatbot_rag - INFO - [analyze_query_with_llm] L·∫•y l·ªãch s·ª≠ t·ª´ get_chat_history: 0 b·∫£n ghi
2025-05-17 11:46:04,843 - chatbot_rag - INFO - [analyze_query_with_llm] S·ª≠ d·ª•ng l·ªãch s·ª≠ h·ªôi tho·∫°i: 0 b·∫£n ghi
2025-05-17 11:46:04,843 - chatbot_rag - INFO - [analyze_query_with_llm] Prompt cu·ªëi c√πng: L·ªãch s·ª≠ tin nh·∫Øn:

C√¢u h·ªèi ng∆∞·ªùi d√πng hi·ªán t·∫°i: "alo /think"

Ph√¢n t√≠ch c√¢u h·ªèi v√† tr·∫£ v·ªÅ JSON c√≥ ƒë·ªãnh d·∫°ng:
{"department": "t√™n ph√≤ng ban ho·∫∑c null", "query_type": "department_specific ho·∫∑c general h...
2025-05-17 11:46:04,844 - chatbot_rag - INFO - K√≠ch th∆∞·ªõc prompt: 483 k√Ω t·ª±
2025-05-17 11:46:04,849 - chatbot_rag - INFO - K√≠ch th∆∞·ªõc system prompt: 4181 k√Ω t·ª±
2025-05-17 11:46:04,855 - chatbot_rag - INFO - T·ªïng k√≠ch th∆∞·ªõc: 4664 k√Ω t·ª±
2025-05-17 11:46:04,872 - chatbot_rag - INFO - ƒê√£ l∆∞u full prompt v√†o file: data/logs/llm_full_prompt_20250517_114604.txt
2025-05-17 11:46:04,879 - chatbot_rag - INFO - System prompt: 
B·∫°n l√† tr·ª£ l√Ω AI chuy√™n ph√¢n t√≠ch n·ªôi dung c√¢u h·ªèi ƒë·ªÉ x√°c ƒë·ªãnh:
1. Ph√≤ng ban m√† ng∆∞·ªùi d√πng ƒëang h·ªèi v·ªÅ (department)
2. Ph√¢n lo·∫°i c√¢u h·ªèi l√† v·ªÅ ph√≤ng ban c·ª• th·ªÉ hay c√¢u h·ªèi chung (query_type)
3. X√°c ƒë...
2025-05-17 11:46:04,886 - chatbot_rag - INFO - User prompt: L·ªãch s·ª≠ tin nh·∫Øn:

C√¢u h·ªèi ng∆∞·ªùi d√πng hi·ªán t·∫°i: "alo /think"

Ph√¢n t√≠ch c√¢u h·ªèi v√† tr·∫£ v·ªÅ JSON c√≥ ƒë·ªãnh d·∫°ng:
{"department": "t√™n ph√≤ng ban ho·∫∑c null", "query_type": "department_specific ho·∫∑c general h...
2025-05-17 11:46:04,892 - chatbot_rag - INFO - G·ª≠i truy v·∫•n ƒë·∫øn LLM API t·∫°i http://localhost:1234/v1/chat/completions v·ªõi stream=False
2025-05-17 11:46:23,452 - chatbot_rag - INFO - M√£ ph·∫£n h·ªìi t·ª´ API: 200
2025-05-17 11:46:23,453 - chatbot_rag - INFO - Ph·∫£n h·ªìi g·ªëc t·ª´ LLM API (200 k√Ω t·ª± ƒë·∫ßu): <think>
Okay, let's tackle this query. The user's current message is "alo". First, I need to check the history to see if there was a previous department mentioned. Since the history is empty, there's 
2025-05-17 11:46:23,455 - chatbot_rag - INFO - ƒê√£ l∆∞u ph·∫£n h·ªìi ƒë·∫ßy ƒë·ªß v√†o file: data/logs/llm_response_20250517_114623.txt
2025-05-17 11:46:23,458 - chatbot_rag - INFO - [analysis_20250517_114623] ƒê√£ ghi ph·∫£n h·ªìi g·ªëc v√†o: data/logs/analysis_20250517_114623_raw.txt
2025-05-17 11:46:23,458 - chatbot_rag - INFO - [analysis_20250517_114623] Ph·∫£n h·ªìi g·ªëc: <think>
Okay, let's tackle this query. The user's current message is "alo". First, I need to check t...
2025-05-17 11:46:23,459 - chatbot_rag - WARNING - [analysis_20250517_114623] Ph√°t hi·ªán th·∫ª <think> trong ph·∫£n h·ªìi. X·ª≠ l√Ω ƒë·∫∑c bi·ªát...
2025-05-17 11:46:23,459 - chatbot_rag - INFO - [analysis_20250517_114623] B∆Ø·ªöC 1: Th·ª≠ parse to√†n b·ªô chu·ªói ph·∫£n h·ªìi
2025-05-17 11:46:23,461 - chatbot_rag - INFO - [analysis_20250517_114623] B∆Ø·ªöC 1: Kh√¥ng ph·∫£i JSON h·ª£p l·ªá: Expecting value: line 1 column 1 (char 0)
2025-05-17 11:46:23,461 - chatbot_rag - INFO - [analysis_20250517_114623] B∆Ø·ªöC 2: T√¨m JSON trong chu·ªói ph·∫£n h·ªìi
2025-05-17 11:46:23,462 - chatbot_rag - WARNING - [analysis_20250517_114623] B∆Ø·ªöC 2: Kh√¥ng t√¨m th·∫•y m·∫´u JSON n√†o trong ph·∫£n h·ªìi
2025-05-17 11:46:23,463 - chatbot_rag - INFO - [analysis_20250517_114623] B∆Ø·ªöC 3: X·ª≠ l√Ω chu·ªói th·ªß c√¥ng ƒë·ªÉ tr√≠ch xu·∫•t th√¥ng tin
2025-05-17 11:46:23,480 - department_info_tool - INFO - ƒê√£ t·∫£i 11 ph√≤ng ban
2025-05-17 11:46:23,482 - department_info_tool - INFO - ƒê√£ l·∫•y danh s√°ch 11 ph√≤ng ban
2025-05-17 11:46:23,488 - chatbot_rag - INFO - [analysis_20250517_114623] B∆Ø·ªöC 3: K·∫øt qu·∫£ ph√¢n t√≠ch th·ªß c√¥ng: {'department': None, 'query_type': 'general', 'error': False}
2025-05-17 11:46:23,489 - websocket_server - INFO - Ph√¢n t√≠ch c√¢u h·ªèi: Ph√≤ng ban=None, Lo·∫°i=general, Thinking=True
2025-05-17 11:46:23,489 - websocket_server - INFO - X·ª≠ l√Ω streaming response cho: 'alo /think', ph√≤ng ban: None, session_id: 284b52f9-dae0-4001-98fc-1e425fa03bf9
2025-05-17 11:46:23,490 - websocket_server - INFO - Session ID nh·∫≠n ƒë∆∞·ª£c: 284b52f9-dae0-4001-98fc-1e425fa03bf9
2025-05-17 11:46:23,492 - websocket_server - INFO - Ph√°t hi·ªán l·ªánh /think, b·∫≠t ch·∫ø ƒë·ªô thinking cho: alo
2025-05-17 11:46:23,493 - websocket_server - INFO - X·ª≠ l√Ω streaming response. Query: 'alo', Mode thinking: True
2025-05-17 11:46:23,493 - websocket_server - INFO - Kh√¥ng c√≥ l·ªãch s·ª≠ tin nh·∫Øn cho phi√™n n√†y
2025-05-17 11:46:23,493 - chatbot_rag - INFO - ƒêang ph√¢n t√≠ch c√¢u h·ªèi v·ªõi LLM: alo, session_id: 284b52f9-dae0-4001-98fc-1e425fa03bf9
2025-05-17 11:46:23,494 - chatbot_rag - WARNING - [analyze_query_with_llm] Kh√¥ng th·ªÉ import get_session_history t·ª´ websocket_server, s·ª≠ d·ª•ng get_chat_history
2025-05-17 11:46:23,496 - chatbot_rag - INFO - [analyze_query_with_llm] L·∫•y l·ªãch s·ª≠ t·ª´ get_chat_history: 0 b·∫£n ghi
2025-05-17 11:46:23,496 - chatbot_rag - INFO - [analyze_query_with_llm] S·ª≠ d·ª•ng l·ªãch s·ª≠ h·ªôi tho·∫°i: 0 b·∫£n ghi
2025-05-17 11:46:23,496 - chatbot_rag - INFO - [analyze_query_with_llm] Prompt cu·ªëi c√πng: L·ªãch s·ª≠ tin nh·∫Øn:

C√¢u h·ªèi ng∆∞·ªùi d√πng hi·ªán t·∫°i: "alo"

Ph√¢n t√≠ch c√¢u h·ªèi v√† tr·∫£ v·ªÅ JSON c√≥ ƒë·ªãnh d·∫°ng:
{"department": "t√™n ph√≤ng ban ho·∫∑c null", "query_type": "department_specific ho·∫∑c general ho·∫∑c nul...
2025-05-17 11:46:23,497 - chatbot_rag - INFO - K√≠ch th∆∞·ªõc prompt: 476 k√Ω t·ª±
2025-05-17 11:46:23,498 - chatbot_rag - INFO - K√≠ch th∆∞·ªõc system prompt: 4181 k√Ω t·ª±
2025-05-17 11:46:23,499 - chatbot_rag - INFO - T·ªïng k√≠ch th∆∞·ªõc: 4657 k√Ω t·ª±
2025-05-17 11:46:23,502 - chatbot_rag - INFO - ƒê√£ l∆∞u full prompt v√†o file: data/logs/llm_full_prompt_20250517_114623.txt
2025-05-17 11:46:23,503 - chatbot_rag - INFO - System prompt: 
B·∫°n l√† tr·ª£ l√Ω AI chuy√™n ph√¢n t√≠ch n·ªôi dung c√¢u h·ªèi ƒë·ªÉ x√°c ƒë·ªãnh:
1. Ph√≤ng ban m√† ng∆∞·ªùi d√πng ƒëang h·ªèi v·ªÅ (department)
2. Ph√¢n lo·∫°i c√¢u h·ªèi l√† v·ªÅ ph√≤ng ban c·ª• th·ªÉ hay c√¢u h·ªèi chung (query_type)
3. X√°c ƒë...
2025-05-17 11:46:23,504 - chatbot_rag - INFO - User prompt: L·ªãch s·ª≠ tin nh·∫Øn:

C√¢u h·ªèi ng∆∞·ªùi d√πng hi·ªán t·∫°i: "alo"

Ph√¢n t√≠ch c√¢u h·ªèi v√† tr·∫£ v·ªÅ JSON c√≥ ƒë·ªãnh d·∫°ng:
{"department": "t√™n ph√≤ng ban ho·∫∑c null", "query_type": "department_specific ho·∫∑c general ho·∫∑c nul...
2025-05-17 11:46:23,505 - chatbot_rag - INFO - G·ª≠i truy v·∫•n ƒë·∫øn LLM API t·∫°i http://localhost:1234/v1/chat/completions v·ªõi stream=False
2025-05-17 11:46:33,627 - chatbot_rag - INFO - M√£ ph·∫£n h·ªìi t·ª´ API: 200
2025-05-17 11:46:33,628 - chatbot_rag - INFO - Ph·∫£n h·ªìi g·ªëc t·ª´ LLM API (200 k√Ω t·ª± ƒë·∫ßu): <think>
Okay, let's tackle this query. The user's current message is "alo", which is a casual way of saying "hello" in Vietnamese. The history doesn't mention any previous department or context.

Firs
2025-05-17 11:46:33,630 - chatbot_rag - INFO - ƒê√£ l∆∞u ph·∫£n h·ªìi ƒë·∫ßy ƒë·ªß v√†o file: data/logs/llm_response_20250517_114633.txt
2025-05-17 11:46:33,632 - chatbot_rag - INFO - [analysis_20250517_114633] ƒê√£ ghi ph·∫£n h·ªìi g·ªëc v√†o: data/logs/analysis_20250517_114633_raw.txt
2025-05-17 11:46:33,632 - chatbot_rag - INFO - [analysis_20250517_114633] Ph·∫£n h·ªìi g·ªëc: <think>
Okay, let's tackle this query. The user's current message is "alo", which is a casual way of...
2025-05-17 11:46:33,633 - chatbot_rag - WARNING - [analysis_20250517_114633] Ph√°t hi·ªán th·∫ª <think> trong ph·∫£n h·ªìi. X·ª≠ l√Ω ƒë·∫∑c bi·ªát...
2025-05-17 11:46:33,633 - chatbot_rag - INFO - [analysis_20250517_114633] B∆Ø·ªöC 1: Th·ª≠ parse to√†n b·ªô chu·ªói ph·∫£n h·ªìi
2025-05-17 11:46:33,633 - chatbot_rag - INFO - [analysis_20250517_114633] B∆Ø·ªöC 1: Kh√¥ng ph·∫£i JSON h·ª£p l·ªá: Expecting value: line 1 column 1 (char 0)
2025-05-17 11:46:33,634 - chatbot_rag - INFO - [analysis_20250517_114633] B∆Ø·ªöC 2: T√¨m JSON trong chu·ªói ph·∫£n h·ªìi
2025-05-17 11:46:33,634 - chatbot_rag - WARNING - [analysis_20250517_114633] B∆Ø·ªöC 2: Kh√¥ng t√¨m th·∫•y m·∫´u JSON n√†o trong ph·∫£n h·ªìi
2025-05-17 11:46:33,636 - chatbot_rag - INFO - [analysis_20250517_114633] B∆Ø·ªöC 3: X·ª≠ l√Ω chu·ªói th·ªß c√¥ng ƒë·ªÉ tr√≠ch xu·∫•t th√¥ng tin
2025-05-17 11:46:33,645 - department_info_tool - INFO - ƒê√£ t·∫£i 11 ph√≤ng ban
2025-05-17 11:46:33,645 - department_info_tool - INFO - ƒê√£ l·∫•y danh s√°ch 11 ph√≤ng ban
2025-05-17 11:46:33,647 - chatbot_rag - INFO - [analysis_20250517_114633] B∆Ø·ªöC 3: K·∫øt qu·∫£ ph√¢n t√≠ch th·ªß c√¥ng: {'department': None, 'query_type': 'general', 'error': False}
2025-05-17 11:46:33,648 - websocket_server - INFO - Ph√¢n t√≠ch c√¢u h·ªèi: Ph√≤ng ban=None, Lo·∫°i=general, Thinking=True
2025-05-17 11:46:33,649 - websocket_server - INFO - Query th·ª±c t·∫ø g·ª≠i ƒë·∫øn m√¥ h√¨nh: alo /think
2025-05-17 11:46:33,649 - websocket_server - INFO - C√¢u h·ªèi chung, ch·∫ø ƒë·ªô thinking: True
2025-05-17 11:46:33,651 - chatbot_rag - INFO - X·ª≠ l√Ω c√¢u h·ªèi chung cho session_id: 284b52f9-dae0-4001-98fc-1e425fa03bf9
2025-05-17 11:46:33,657 - department_info_tool - INFO - ƒê√£ t·∫£i 11 ph√≤ng ban
2025-05-17 11:46:33,658 - department_info_tool - INFO - ƒê√£ l·∫•y danh s√°ch 11 ph√≤ng ban
2025-05-17 11:46:33,660 - chatbot_rag - INFO - G·ªçi LLM ƒë·ªÉ tr·∫£ l·ªùi c√¢u h·ªèi chung cho session_id: 284b52f9-dae0-4001-98fc-1e425fa03bf9
2025-05-17 11:46:33,661 - chatbot_rag - INFO - ƒê√£ l∆∞u prompt v√†o file: data/logs/prompt_general_20250517_114633.txt
2025-05-17 11:46:33,663 - chatbot_rag - INFO - K√≠ch th∆∞·ªõc prompt: 1622 k√Ω t·ª±
2025-05-17 11:46:33,663 - chatbot_rag - INFO - K√≠ch th∆∞·ªõc system prompt: 1059 k√Ω t·ª±
2025-05-17 11:46:33,664 - chatbot_rag - INFO - T·ªïng k√≠ch th∆∞·ªõc: 2681 k√Ω t·ª±
2025-05-17 11:46:33,665 - chatbot_rag - INFO - ƒê√£ l∆∞u full prompt v√†o file: data/logs/llm_full_prompt_20250517_114633.txt
2025-05-17 11:46:33,665 - chatbot_rag - INFO - System prompt: 
B·∫°n l√† tr·ª£ l√Ω AI chuy√™n v·ªÅ quy tr√¨nh v√† giai ƒëo·∫°n trong c√¥ng ty.

C√ÅC PH√íNG BAN THAM GIA THEO GIAI ƒêO·∫†N:
- MKT-SALES: Marketing, Kinh doanh
- PROPOSAL: Kinh doanh, D·ª± to√°n, Thi·∫øt k·∫ø, Team d·ª± √°n
- CON...
2025-05-17 11:46:33,666 - chatbot_rag - INFO - User prompt: 
C√¢u h·ªèi: "alo /think"

ƒê√¢y l√† c√¢u h·ªèi chung v·ªÅ quy tr√¨nh ho·∫∑c giai ƒëo·∫°n l√†m vi·ªác.

Th√¥ng tin c∆° b·∫£n:
### Th√¥ng tin t·ªïng quan v·ªÅ quy tr√¨nh v√† giai ƒëo·∫°n

#### Giai ƒëo·∫°n ch√≠nh trong quy tr√¨nh:
1. **MKT-...
2025-05-17 11:46:33,667 - chatbot_rag - INFO - G·ª≠i truy v·∫•n ƒë·∫øn LLM API t·∫°i http://localhost:1234/v1/chat/completions v·ªõi stream=True
2025-05-17 11:46:57,002 - chatbot_rag - INFO - M√£ ph·∫£n h·ªìi t·ª´ API: 200
2025-05-17 11:46:57,003 - chatbot_rag - INFO - Ph·∫£n h·ªìi g·ªëc t·ª´ LLM API (200 k√Ω t·ª± ƒë·∫ßu): <think>
Okay, the user asked "alo /think" which is a casual way of saying "hello" or "what's up?" in Vietnamese. They mentioned it's a general question about the process or stages. I need to respond b
2025-05-17 11:46:57,005 - chatbot_rag - INFO - ƒê√£ l∆∞u ph·∫£n h·ªìi ƒë·∫ßy ƒë·ªß v√†o file: data/logs/llm_response_20250517_114657.txt
2025-05-17 11:46:57,010 - websocket_server - INFO - ƒê√£ tr√≠ch xu·∫•t thinking (1472 k√Ω t·ª±) v√† c√≤n l·∫°i 465 k√Ω t·ª± ph·∫£n h·ªìi
2025-05-17 11:46:57,011 - websocket_server - INFO - ƒê√£ tr√≠ch xu·∫•t ph·∫ßn thinking (1472 k√Ω t·ª±) t·ª´ ph·∫£n h·ªìi
2025-05-17 11:46:57,012 - websocket_server - INFO - ƒê√£ l∆∞u h·ªôi tho·∫°i chung v√†o l·ªãch s·ª≠ c·ªßa session 284b52f9-dae0-4001-98fc-1e425fa03bf9
2025-05-17 11:48:34,120 - websocket_server - INFO - Nh·∫≠n tin nh·∫Øn d·∫°ng JSON: {"content":"m√†y l√† ai /think","session_id":"284b52f9-dae0-4001-98fc-1e425fa03bf9"}
2025-05-17 11:48:34,121 - websocket_server - INFO - Session ID t·ª´ client (sau khi ki·ªÉm tra): 284b52f9-dae0-4001-98fc-1e425fa03bf9
2025-05-17 11:48:34,121 - websocket_server - INFO - B·∫≠t ch·∫ø ƒë·ªô thinking cho c√¢u h·ªèi: m√†y l√† ai /think...
2025-05-17 11:48:34,121 - websocket_server - INFO - Nh·∫≠n tin nh·∫Øn th√¥ng th∆∞·ªùng: m√†y l√† ai /think, enable_thinking=True
2025-05-17 11:48:34,122 - websocket_server - INFO - ƒê√£ th√™m 1 tin nh·∫Øn g·∫ßn nh·∫•t v√†o prompt
2025-05-17 11:48:34,124 - websocket_server - INFO - ƒê√£ l∆∞u l·ªãch s·ª≠ tin nh·∫Øn v√† prompt v√†o file: data/logs/history_prompt_20250517_114834.txt
2025-05-17 11:48:34,125 - chatbot_rag - INFO - ƒêang ph√¢n t√≠ch c√¢u h·ªèi v·ªõi LLM: L·ªãch s·ª≠ tin nh·∫Øn:
Ng∆∞·ªùi d√πng: alo

m√†y l√† ai /think, session_id: 284b52f9-dae0-4001-98fc-1e425fa03bf9
2025-05-17 11:48:34,126 - chatbot_rag - WARNING - [analyze_query_with_llm] Kh√¥ng th·ªÉ import get_session_history t·ª´ websocket_server, s·ª≠ d·ª•ng get_chat_history
2025-05-17 11:48:34,127 - chatbot_rag - INFO - [analyze_query_with_llm] L·∫•y l·ªãch s·ª≠ t·ª´ get_chat_history: 0 b·∫£n ghi
2025-05-17 11:48:34,127 - chatbot_rag - INFO - [analyze_query_with_llm] S·ª≠ d·ª•ng l·ªãch s·ª≠ h·ªôi tho·∫°i: 0 b·∫£n ghi
2025-05-17 11:48:34,127 - chatbot_rag - INFO - [analyze_query_with_llm] Prompt cu·ªëi c√πng: L·ªãch s·ª≠ tin nh·∫Øn:

C√¢u h·ªèi ng∆∞·ªùi d√πng hi·ªán t·∫°i: "L·ªãch s·ª≠ tin nh·∫Øn:
Ng∆∞·ªùi d√πng: alo

m√†y l√† ai /think"

Ph√¢n t√≠ch c√¢u h·ªèi v√† tr·∫£ v·ªÅ JSON c√≥ ƒë·ªãnh d·∫°ng:
{"department": "t√™n ph√≤ng ban ho·∫∑c null", "query_t...
2025-05-17 11:48:34,128 - chatbot_rag - INFO - K√≠ch th∆∞·ªõc prompt: 524 k√Ω t·ª±
2025-05-17 11:48:34,128 - chatbot_rag - INFO - K√≠ch th∆∞·ªõc system prompt: 4181 k√Ω t·ª±
2025-05-17 11:48:34,129 - chatbot_rag - INFO - T·ªïng k√≠ch th∆∞·ªõc: 4705 k√Ω t·ª±
2025-05-17 11:48:34,131 - chatbot_rag - INFO - ƒê√£ l∆∞u full prompt v√†o file: data/logs/llm_full_prompt_20250517_114834.txt
2025-05-17 11:48:34,132 - chatbot_rag - INFO - System prompt: 
B·∫°n l√† tr·ª£ l√Ω AI chuy√™n ph√¢n t√≠ch n·ªôi dung c√¢u h·ªèi ƒë·ªÉ x√°c ƒë·ªãnh:
1. Ph√≤ng ban m√† ng∆∞·ªùi d√πng ƒëang h·ªèi v·ªÅ (department)
2. Ph√¢n lo·∫°i c√¢u h·ªèi l√† v·ªÅ ph√≤ng ban c·ª• th·ªÉ hay c√¢u h·ªèi chung (query_type)
3. X√°c ƒë...
2025-05-17 11:48:34,132 - chatbot_rag - INFO - User prompt: L·ªãch s·ª≠ tin nh·∫Øn:

C√¢u h·ªèi ng∆∞·ªùi d√πng hi·ªán t·∫°i: "L·ªãch s·ª≠ tin nh·∫Øn:
Ng∆∞·ªùi d√πng: alo

m√†y l√† ai /think"

Ph√¢n t√≠ch c√¢u h·ªèi v√† tr·∫£ v·ªÅ JSON c√≥ ƒë·ªãnh d·∫°ng:
{"department": "t√™n ph√≤ng ban ho·∫∑c null", "query_t...
2025-05-17 11:48:34,134 - chatbot_rag - INFO - G·ª≠i truy v·∫•n ƒë·∫øn LLM API t·∫°i http://localhost:1234/v1/chat/completions v·ªõi stream=False
2025-05-17 11:48:52,863 - chatbot_rag - INFO - M√£ ph·∫£n h·ªìi t·ª´ API: 200
2025-05-17 11:48:52,866 - chatbot_rag - INFO - Ph·∫£n h·ªìi g·ªëc t·ª´ LLM API (200 k√Ω t·ª± ƒë·∫ßu): <think>
Okay, let's tackle this query. The user's current question is "L·ªãch s·ª≠ tin nh·∫Øn: Ng∆∞·ªùi d√πng: alo m√†y l√† ai /think". First, I need to parse the input correctly.

The user is asking about their 
2025-05-17 11:48:52,870 - chatbot_rag - INFO - ƒê√£ l∆∞u ph·∫£n h·ªìi ƒë·∫ßy ƒë·ªß v√†o file: data/logs/llm_response_20250517_114852.txt
2025-05-17 11:48:52,872 - chatbot_rag - INFO - [analysis_20250517_114852] ƒê√£ ghi ph·∫£n h·ªìi g·ªëc v√†o: data/logs/analysis_20250517_114852_raw.txt
2025-05-17 11:48:52,873 - chatbot_rag - INFO - [analysis_20250517_114852] Ph·∫£n h·ªìi g·ªëc: <think>
Okay, let's tackle this query. The user's current question is "L·ªãch s·ª≠ tin nh·∫Øn: Ng∆∞·ªùi d√πng:...
2025-05-17 11:48:52,873 - chatbot_rag - WARNING - [analysis_20250517_114852] Ph√°t hi·ªán th·∫ª <think> trong ph·∫£n h·ªìi. X·ª≠ l√Ω ƒë·∫∑c bi·ªát...
2025-05-17 11:48:52,873 - chatbot_rag - INFO - [analysis_20250517_114852] B∆Ø·ªöC 1: Th·ª≠ parse to√†n b·ªô chu·ªói ph·∫£n h·ªìi
2025-05-17 11:48:52,874 - chatbot_rag - INFO - [analysis_20250517_114852] B∆Ø·ªöC 1: Kh√¥ng ph·∫£i JSON h·ª£p l·ªá: Expecting value: line 1 column 1 (char 0)
2025-05-17 11:48:52,874 - chatbot_rag - INFO - [analysis_20250517_114852] B∆Ø·ªöC 2: T√¨m JSON trong chu·ªói ph·∫£n h·ªìi
2025-05-17 11:48:52,874 - chatbot_rag - WARNING - [analysis_20250517_114852] B∆Ø·ªöC 2: Kh√¥ng t√¨m th·∫•y m·∫´u JSON n√†o trong ph·∫£n h·ªìi
2025-05-17 11:48:52,875 - chatbot_rag - INFO - [analysis_20250517_114852] B∆Ø·ªöC 3: X·ª≠ l√Ω chu·ªói th·ªß c√¥ng ƒë·ªÉ tr√≠ch xu·∫•t th√¥ng tin
2025-05-17 11:48:52,879 - department_info_tool - INFO - ƒê√£ t·∫£i 11 ph√≤ng ban
2025-05-17 11:48:52,880 - department_info_tool - INFO - ƒê√£ l·∫•y danh s√°ch 11 ph√≤ng ban
2025-05-17 11:48:52,880 - chatbot_rag - INFO - [analysis_20250517_114852] B∆Ø·ªöC 3: K·∫øt qu·∫£ ph√¢n t√≠ch th·ªß c√¥ng: {'department': None, 'query_type': 'general', 'error': False}
2025-05-17 11:48:52,880 - websocket_server - INFO - Ph√¢n t√≠ch c√¢u h·ªèi: Ph√≤ng ban=None, Lo·∫°i=general, Thinking=True
2025-05-17 11:48:52,881 - websocket_server - INFO - X·ª≠ l√Ω streaming response cho: 'm√†y l√† ai /think', ph√≤ng ban: None, session_id: 284b52f9-dae0-4001-98fc-1e425fa03bf9
2025-05-17 11:48:52,881 - websocket_server - INFO - Session ID nh·∫≠n ƒë∆∞·ª£c: 284b52f9-dae0-4001-98fc-1e425fa03bf9
2025-05-17 11:48:52,881 - websocket_server - INFO - Ph√°t hi·ªán l·ªánh /think, b·∫≠t ch·∫ø ƒë·ªô thinking cho: m√†y l√† ai
2025-05-17 11:48:52,882 - websocket_server - INFO - X·ª≠ l√Ω streaming response. Query: 'm√†y l√† ai', Mode thinking: True
2025-05-17 11:48:52,883 - websocket_server - INFO - ƒê√£ th√™m 1 tin nh·∫Øn g·∫ßn nh·∫•t v√†o prompt
2025-05-17 11:48:52,885 - websocket_server - INFO - ƒê√£ l∆∞u l·ªãch s·ª≠ tin nh·∫Øn v√† prompt v√†o file: data/logs/history_prompt_20250517_114852.txt
2025-05-17 11:48:52,886 - chatbot_rag - INFO - ƒêang ph√¢n t√≠ch c√¢u h·ªèi v·ªõi LLM: L·ªãch s·ª≠ tin nh·∫Øn:
Ng∆∞·ªùi d√πng: alo

m√†y l√† ai, session_id: 284b52f9-dae0-4001-98fc-1e425fa03bf9
2025-05-17 11:48:52,887 - chatbot_rag - WARNING - [analyze_query_with_llm] Kh√¥ng th·ªÉ import get_session_history t·ª´ websocket_server, s·ª≠ d·ª•ng get_chat_history
2025-05-17 11:48:52,888 - chatbot_rag - INFO - [analyze_query_with_llm] L·∫•y l·ªãch s·ª≠ t·ª´ get_chat_history: 0 b·∫£n ghi
2025-05-17 11:48:52,888 - chatbot_rag - INFO - [analyze_query_with_llm] S·ª≠ d·ª•ng l·ªãch s·ª≠ h·ªôi tho·∫°i: 0 b·∫£n ghi
2025-05-17 11:48:52,888 - chatbot_rag - INFO - [analyze_query_with_llm] Prompt cu·ªëi c√πng: L·ªãch s·ª≠ tin nh·∫Øn:

C√¢u h·ªèi ng∆∞·ªùi d√πng hi·ªán t·∫°i: "L·ªãch s·ª≠ tin nh·∫Øn:
Ng∆∞·ªùi d√πng: alo

m√†y l√† ai"

Ph√¢n t√≠ch c√¢u h·ªèi v√† tr·∫£ v·ªÅ JSON c√≥ ƒë·ªãnh d·∫°ng:
{"department": "t√™n ph√≤ng ban ho·∫∑c null", "query_type": "...
2025-05-17 11:48:52,889 - chatbot_rag - INFO - K√≠ch th∆∞·ªõc prompt: 517 k√Ω t·ª±
2025-05-17 11:48:52,889 - chatbot_rag - INFO - K√≠ch th∆∞·ªõc system prompt: 4181 k√Ω t·ª±
2025-05-17 11:48:52,889 - chatbot_rag - INFO - T·ªïng k√≠ch th∆∞·ªõc: 4698 k√Ω t·ª±
2025-05-17 11:48:52,890 - chatbot_rag - INFO - ƒê√£ l∆∞u full prompt v√†o file: data/logs/llm_full_prompt_20250517_114852.txt
2025-05-17 11:48:52,891 - chatbot_rag - INFO - System prompt: 
B·∫°n l√† tr·ª£ l√Ω AI chuy√™n ph√¢n t√≠ch n·ªôi dung c√¢u h·ªèi ƒë·ªÉ x√°c ƒë·ªãnh:
1. Ph√≤ng ban m√† ng∆∞·ªùi d√πng ƒëang h·ªèi v·ªÅ (department)
2. Ph√¢n lo·∫°i c√¢u h·ªèi l√† v·ªÅ ph√≤ng ban c·ª• th·ªÉ hay c√¢u h·ªèi chung (query_type)
3. X√°c ƒë...
2025-05-17 11:48:52,891 - chatbot_rag - INFO - User prompt: L·ªãch s·ª≠ tin nh·∫Øn:

C√¢u h·ªèi ng∆∞·ªùi d√πng hi·ªán t·∫°i: "L·ªãch s·ª≠ tin nh·∫Øn:
Ng∆∞·ªùi d√πng: alo

m√†y l√† ai"

Ph√¢n t√≠ch c√¢u h·ªèi v√† tr·∫£ v·ªÅ JSON c√≥ ƒë·ªãnh d·∫°ng:
{"department": "t√™n ph√≤ng ban ho·∫∑c null", "query_type": "...
2025-05-17 11:48:52,891 - chatbot_rag - INFO - G·ª≠i truy v·∫•n ƒë·∫øn LLM API t·∫°i http://localhost:1234/v1/chat/completions v·ªõi stream=False
2025-05-17 11:49:02,907 - chatbot_rag - INFO - M√£ ph·∫£n h·ªìi t·ª´ API: 200
2025-05-17 11:49:02,908 - chatbot_rag - INFO - Ph·∫£n h·ªìi g·ªëc t·ª´ LLM API (200 k√Ω t·ª± ƒë·∫ßu): <think>
Okay, let's tackle this query. The user's current message is "L·ªãch s·ª≠ tin nh·∫Øn: Ng∆∞·ªùi d√πng: alo m√†y l√† ai". First, I need to parse the history and the current question.

Looking at the history
2025-05-17 11:49:02,915 - chatbot_rag - INFO - ƒê√£ l∆∞u ph·∫£n h·ªìi ƒë·∫ßy ƒë·ªß v√†o file: data/logs/llm_response_20250517_114902.txt
2025-05-17 11:49:02,917 - chatbot_rag - INFO - [analysis_20250517_114902] ƒê√£ ghi ph·∫£n h·ªìi g·ªëc v√†o: data/logs/analysis_20250517_114902_raw.txt
2025-05-17 11:49:02,917 - chatbot_rag - INFO - [analysis_20250517_114902] Ph·∫£n h·ªìi g·ªëc: <think>
Okay, let's tackle this query. The user's current message is "L·ªãch s·ª≠ tin nh·∫Øn: Ng∆∞·ªùi d√πng: ...
2025-05-17 11:49:02,918 - chatbot_rag - WARNING - [analysis_20250517_114902] Ph√°t hi·ªán th·∫ª <think> trong ph·∫£n h·ªìi. X·ª≠ l√Ω ƒë·∫∑c bi·ªát...
2025-05-17 11:49:02,918 - chatbot_rag - INFO - [analysis_20250517_114902] B∆Ø·ªöC 1: Th·ª≠ parse to√†n b·ªô chu·ªói ph·∫£n h·ªìi
2025-05-17 11:49:02,918 - chatbot_rag - INFO - [analysis_20250517_114902] B∆Ø·ªöC 1: Kh√¥ng ph·∫£i JSON h·ª£p l·ªá: Expecting value: line 1 column 1 (char 0)
2025-05-17 11:49:02,919 - chatbot_rag - INFO - [analysis_20250517_114902] B∆Ø·ªöC 2: T√¨m JSON trong chu·ªói ph·∫£n h·ªìi
2025-05-17 11:49:02,919 - chatbot_rag - WARNING - [analysis_20250517_114902] B∆Ø·ªöC 2: Kh√¥ng t√¨m th·∫•y m·∫´u JSON n√†o trong ph·∫£n h·ªìi
2025-05-17 11:49:02,919 - chatbot_rag - INFO - [analysis_20250517_114902] B∆Ø·ªöC 3: X·ª≠ l√Ω chu·ªói th·ªß c√¥ng ƒë·ªÉ tr√≠ch xu·∫•t th√¥ng tin
2025-05-17 11:49:02,927 - department_info_tool - INFO - ƒê√£ t·∫£i 11 ph√≤ng ban
2025-05-17 11:49:02,928 - department_info_tool - INFO - ƒê√£ l·∫•y danh s√°ch 11 ph√≤ng ban
2025-05-17 11:49:02,928 - chatbot_rag - INFO - [analysis_20250517_114902] B∆Ø·ªöC 3: K·∫øt qu·∫£ ph√¢n t√≠ch th·ªß c√¥ng: {'department': None, 'query_type': 'general', 'error': False}
2025-05-17 11:49:02,929 - websocket_server - INFO - Ph√¢n t√≠ch c√¢u h·ªèi: Ph√≤ng ban=None, Lo·∫°i=general, Thinking=True
2025-05-17 11:49:02,929 - websocket_server - INFO - Query th·ª±c t·∫ø g·ª≠i ƒë·∫øn m√¥ h√¨nh: m√†y l√† ai /think
2025-05-17 11:49:02,929 - websocket_server - INFO - C√¢u h·ªèi chung, ch·∫ø ƒë·ªô thinking: True
2025-05-17 11:49:02,929 - chatbot_rag - INFO - X·ª≠ l√Ω c√¢u h·ªèi chung cho session_id: 284b52f9-dae0-4001-98fc-1e425fa03bf9
2025-05-17 11:49:02,932 - department_info_tool - INFO - ƒê√£ t·∫£i 11 ph√≤ng ban
2025-05-17 11:49:02,932 - department_info_tool - INFO - ƒê√£ l·∫•y danh s√°ch 11 ph√≤ng ban
2025-05-17 11:49:02,933 - chatbot_rag - INFO - G·ªçi LLM ƒë·ªÉ tr·∫£ l·ªùi c√¢u h·ªèi chung cho session_id: 284b52f9-dae0-4001-98fc-1e425fa03bf9
2025-05-17 11:49:02,934 - chatbot_rag - INFO - ƒê√£ l∆∞u prompt v√†o file: data/logs/prompt_general_20250517_114902.txt
2025-05-17 11:49:02,936 - chatbot_rag - INFO - K√≠ch th∆∞·ªõc prompt: 1628 k√Ω t·ª±
2025-05-17 11:49:02,936 - chatbot_rag - INFO - K√≠ch th∆∞·ªõc system prompt: 1059 k√Ω t·ª±
2025-05-17 11:49:02,937 - chatbot_rag - INFO - T·ªïng k√≠ch th∆∞·ªõc: 2687 k√Ω t·ª±
2025-05-17 11:49:02,938 - chatbot_rag - INFO - ƒê√£ l∆∞u full prompt v√†o file: data/logs/llm_full_prompt_20250517_114902.txt
2025-05-17 11:49:02,939 - chatbot_rag - INFO - System prompt: 
B·∫°n l√† tr·ª£ l√Ω AI chuy√™n v·ªÅ quy tr√¨nh v√† giai ƒëo·∫°n trong c√¥ng ty.

C√ÅC PH√íNG BAN THAM GIA THEO GIAI ƒêO·∫†N:
- MKT-SALES: Marketing, Kinh doanh
- PROPOSAL: Kinh doanh, D·ª± to√°n, Thi·∫øt k·∫ø, Team d·ª± √°n
- CON...
2025-05-17 11:49:02,939 - chatbot_rag - INFO - User prompt: 
C√¢u h·ªèi: "m√†y l√† ai /think"

ƒê√¢y l√† c√¢u h·ªèi chung v·ªÅ quy tr√¨nh ho·∫∑c giai ƒëo·∫°n l√†m vi·ªác.

Th√¥ng tin c∆° b·∫£n:
### Th√¥ng tin t·ªïng quan v·ªÅ quy tr√¨nh v√† giai ƒëo·∫°n

#### Giai ƒëo·∫°n ch√≠nh trong quy tr√¨nh:
1. ...
2025-05-17 11:49:02,940 - chatbot_rag - INFO - G·ª≠i truy v·∫•n ƒë·∫øn LLM API t·∫°i http://localhost:1234/v1/chat/completions v·ªõi stream=True
2025-05-17 11:49:27,720 - chatbot_rag - INFO - M√£ ph·∫£n h·ªìi t·ª´ API: 200
2025-05-17 11:49:27,722 - chatbot_rag - INFO - Ph·∫£n h·ªìi g·ªëc t·ª´ LLM API (200 k√Ω t·ª± ƒë·∫ßu): <think>
Okay, let's see. The user asked "m√†y l√† ai" which is a general question about the process or stages. I need to follow the strict rules provided.

First, the instructions say not to create conn
2025-05-17 11:49:27,724 - chatbot_rag - INFO - ƒê√£ l∆∞u ph·∫£n h·ªìi ƒë·∫ßy ƒë·ªß v√†o file: data/logs/llm_response_20250517_114927.txt
2025-05-17 11:49:27,729 - websocket_server - INFO - ƒê√£ tr√≠ch xu·∫•t thinking (895 k√Ω t·ª±) v√† c√≤n l·∫°i 1006 k√Ω t·ª± ph·∫£n h·ªìi
2025-05-17 11:49:27,729 - websocket_server - INFO - ƒê√£ tr√≠ch xu·∫•t ph·∫ßn thinking (895 k√Ω t·ª±) t·ª´ ph·∫£n h·ªìi
2025-05-17 11:49:27,737 - websocket_server - INFO - ƒê√£ l∆∞u h·ªôi tho·∫°i chung v√†o l·ªãch s·ª≠ c·ªßa session 284b52f9-dae0-4001-98fc-1e425fa03bf9
2025-05-17 13:36:45,708 - websockets.server - INFO - server closing
2025-05-17 13:36:45,735 - websockets.server - INFO - server closed
2025-05-17 13:36:45,777 - websocket_server - INFO - Server b·ªã d·ª´ng b·ªüi ng∆∞·ªùi d√πng
